<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Products - Mini Shop</title>
    <link rel="stylesheet" href="assets/styles.css">
</head>
<body>
    <header>
        <div class="container">
            <h1><a href="index.html" style="color:inherit; text-decoration:none;">Mini Shop</a></h1>
            <nav>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="products.html">Products</a></li>
                    <li><a href="#cart">Cart</a></li>
                    <li><a href="#contact">Contact</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <section id="products">
            <div class="container">
                <div class="products-header">
                    <h2>All Products</h2>
                    <div class="filters">
                        <button data-filter="all" class="active">All</button>
                        <button data-filter="featured">Featured</button>
                        <button data-filter="on-sale">On Sale</button>
                        <button data-filter="top-rated">Top Rated</button>
                    </div>
                </div>

                <div class="product-list" id="product-list">
                    <!-- Products rendered here -->
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 Ecommerce Shop. All rights reserved.</p>
        </div>
    </footer>

    <script>
    // Fetch product data and render
    (function(){
        const list = document.getElementById('product-list');
        const filters = document.querySelectorAll('.products-header .filters button');
        let products = [];

        function starText(r){
            // simple star representation
            const full = Math.round(r);
            return '★★★★★'.slice(0, full) + (full < 5 ? '☆'.repeat(5-full) : '');
        }

        function render(){
            list.innerHTML = '';
            products.forEach(p => {
                const div = document.createElement('div');
                div.className = 'product';
                div.setAttribute('data-tags', p.tags.join(' '));

                const badge = p.tags.includes('featured') ? '<div class="badge">Featured</div>' : (p.tags.includes('on-sale')? '<div class="badge sale">Sale</div>' : '');
                const oldPrice = p.oldPrice ? `<span class="old">$${p.oldPrice.toFixed(2)}</span>` : '';

                div.innerHTML = `\n                    ${badge}\n                    <img src="${p.image}" alt="${p.title}">\n                    <h3>${p.title}</h3>\n                    <div class="rating" aria-label="${p.rating} out of 5 stars">${starText(p.rating)}<span>${p.rating.toFixed(1)}</span></div>\n                    <p class="price">${oldPrice} <strong>$${p.price.toFixed(2)}</strong></p>\n                    <ul class="features">${p.features.map(f => `<li>${f}</li>`).join('')}</ul>\n                    <div class="actions"><button class="add">Add to Cart</button><button class="view">View</button></div>\n                `;

                list.appendChild(div);
            });
        }

        function applyFilter(tag){
            const items = list.querySelectorAll('.product');
            items.forEach(it => {
                const tags = it.getAttribute('data-tags') || '';
                it.style.display = (tag === 'all' || tags.indexOf(tag) !== -1) ? '' : 'none';
            });
        }

        filters.forEach(b => {
            b.addEventListener('click', () => {
                filters.forEach(x => x.classList.remove('active'));
                b.classList.add('active');
                applyFilter(b.getAttribute('data-filter'));
            });
        });

        fetch('assets/products.json')
            .then(r => r.json())
            .then(data => { products = data; render(); })
            .catch(err => { list.innerHTML = '<p>Failed to load products.</p>'; console.error(err); });
    })();
    </script>
</body>
</html>